{# modules/articles-page/views/index.html #} {% extends "layout.html" %} {%
import '@apostrophecms/pager:macros.html' as pager with context %} {% set tags =
data.piecesFilters.tags %} {% block main %}
<div>
  <div>
    <div>{% area data.page, 'main' %}</div>
    <form action="" method="GET">
      <input
        type="text"
        name="search"
        placeholder="Search here..."
        value="{{ data.query.search | safe }}"
      />
      <button type="submit">Search</button>
      {% if data.query.search %}
      <button
        type="button"
        onclick="window.location.href='{{ data.url | build({search: null}) }}'"
      >
        Clear Search
      </button>
      {% endif %}
    </form>
    <div>
      <p>Tags:</p>
      <ul>
        {% for tag in tags %} {% if tag.value in data.url %}
        <li>
          <a href="{{ data.url | build({}, { tags: { $pull: tag.value } }) }}">
            {{ tag.label }}
          </a>
        </li>
        {% else %}
        <li>
          <a
            href="{{ data.url | build({}, { tags: { $addToSet: tag.value } }) }}"
          >
            {{ tag.label }}
          </a>
        </li>
        {% endif %} {% endfor %}
        <li>
          <a href="{{ data.page._url }}"> Clear all </a>
        </li>
      </ul>
    </div>

    <div>
      {% for article in data.pieces %}
      <a href="{{ article._url }}">
        {% set banner = apos.image.first(article.heroImage) %} {% if banner is
        defined %}
        <img
          loading="lazy"
          src="{{ apos.attachment.url(banner, { size: data.options.size or 'full' }) }}"
          alt="{{ banner._alt or '' }}"
          width="{{ apos.attachment.getWidth(banner) }}"
          height="{{ apos.attachment.getHeight(banner) }}"
        />
        {% else %}
        <div>
          <img
            loading="lazy"
            src="/images/logo.svg"
            alt="Placeholder banner for {{ article.title }} "
            width="160"
            height="50"
          />
        </div>
        {% endif %}
        <div>
          <h5>{{ article.title }}</h5>
          {% if article.authorInfo %} {% if article.authorInfo.authorName %}
          <div>
            <span></span>
            <p>
              By
              <span> {{ article.authorInfo.authorName }}</span>
            </p>
          </div>
          {% endif %} {% endif %} {% if article.summary %}
          <p>{{ article.summary }}</p>
          {% endif %}
        </div>
      </a>
      {% endfor %}
    </div>
    <div>
      {{ pager.render({ page: data.currentPage, total: data.totalPages, class:
      'blog-pager' }, data.url) }}
    </div>
  </div>
</div>
{% endblock main %}
