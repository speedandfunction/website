{# modules/articles-page/views/index.html #} {% extends "layout.html" %} {%
import '@apostrophecms/pager:macros.html' as pager with context %} {% set tags =
data.piecesFilters.tags %} {% block main %}
<div class="tfp-default-page">
  <div class="container mx-auto my-14 md:my-40 px-4">
    <form action="" method="GET">
      <input
        type="text"
        name="search"
        placeholder="Search here..."
        value="{{ data.query.search | safe }}"
      />
      <button type="submit">Search</button>
      {% if data.query.search %}
      <button
        type="button"
        onclick="window.location.href='{{ data.url | build({search: null}) }}'"
      >
        Clear Search
      </button>
      {% endif %}
    </form>
    <div
      class="flex flex-col lg:flex-row lg:justify-between gap-5 mb-7 md:mb-14"
    >
      <p>Top topics:</p>
      <ul class="flex flex-wrap gap-2 md:gap-3">
        {% for tag in tags %} {% if tag.value in data.url %}
        <li>
          <a
            class="inline-block uppercase text-xxs md:text-xs bg-primary-darkgrey text-primary-white border border-primary-darkgrey py-1 px-2 rounded-md"
            href="{{ data.url | build({}, { tags: { $pull: tag.value } }) }}"
          >
            {{ tag.label }}
          </a>
        </li>
        {% else %}
        <li>
          <a
            class="inline-block uppercase text-xxs md:text-xs text-primary-bronze border border-primary-bronze/40 py-1 px-2 rounded-md hover:bg-primary-darkgrey hover:text-white"
            href="{{ data.url | build({}, { tags: { $addToSet: tag.value } }) }}"
          >
            {{ tag.label }}
          </a>
        </li>
        {% endif %} {% endfor %}
        <li>
          <a
            class="inline-block uppercase text-xxs md:text-xs border border-primary-bronze/40 py-1 px-2 rounded-md {% if not data.query.tags %} bg-primary-bronze text-primary-white {% else %} text-primary-bronze hover:bg-primary-bronze hover:text-white {% endif %}"
            href="/blog"
          >
            View ALL
          </a>
        </li>
      </ul>
    </div>

    <div
      class="grid md:grid-cols-2 lg:grid-cols-3 gap-5 mb-7 md:mb-14 md:gap-y-14"
    >
      {% for article in data.pieces %}
      <a
        href="{{ article._url }}"
        class="group block relative bg-primary-beige"
      >
        {% set banner = apos.image.first(article.heroImage) %} {% if banner is
        defined %}
        <img
          loading="lazy"
          class="object-cover w-full h-[216px] sm:h-[270px]"
          src="{{ apos.attachment.url(banner, { size: data.options.size or 'full' }) }}"
          alt="{{ banner._alt or '' }}"
          width="{{ apos.attachment.getWidth(banner) }}"
          height="{{ apos.attachment.getHeight(banner) }}"
        />
        {% else %}
        <div
          class="w-full h-[216px] sm:h-[270px] bg-primary-light flex justify-center items-center mb-6"
        >
          <img
            loading="lazy"
            src="../../images/logo.svg"
            alt="Placeholder banner for {{ article.title }} "
            width="160"
            height="50"
          />
        </div>
        {% endif %}
        <div class="relative m-7 md:m-10">
          <h5 class="font-sans-serif text-2xl md:text-3xl">
            {{ article.title }}
          </h5>
          {% if article.authorInfo %} {% if article.authorInfo.authorName %}
          <div class="flex gap-2 items-center mt-2 mb-6">
            <span class="icon-user text-3xl leading-none"></span>
            <p class="tfp-text-sm">
              By
              <span class="notranslate">
                {{ article.authorInfo.authorName }}</span
              >
            </p>
          </div>
          {% endif %} {% endif %} {% if article.summary %}
          <p class="hidden md:inline-block">{{ article.summary }}</p>
          {% endif %}
          <span
            class="block text-sm md:text-base font-sans-serif mt-5 underline text-primary-bronze"
            >Read article</span
          >
        </div>
      </a>
      {% endfor %}
    </div>
    <div
      class="mt-8 md:mt-14 w-full [&>div]:w-full [&>div]:bg-primary-white [&>div]:text-center [&>div]:rounded-md [&>div]:p-4 [&>div]:font-serif [&_span]:pt-1 [&_span]:pb-2 [&_span]:px-2 [&_span]:rounded-sm [&_.is-active]:text-primary-white [&_.is-active]:bg-primary-main"
    >
      {{ pager.render({ page: data.currentPage, total: data.totalPages, class:
      'blog-pager' }, data.url) }}
    </div>
  </div>
</div>
{% endblock main %}
